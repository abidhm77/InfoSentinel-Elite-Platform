<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>InfoSentinel - Security Statistics</title>
    <link rel="stylesheet" href="css/cyberpunk-unified.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
</head>
<body>
    <!-- Unified Navigation -->
    <nav class="cyber-nav">
        <a href="index-unified.html" class="nav-brand">
            <div class="nav-logo">IS</div>
            <div class="nav-title">InfoSentinel</div>
        </a>
        
        <ul class="nav-links" id="navLinks">
            <li><a href="index-unified.html" class="nav-link">Dashboard</a></li>
            <li><a href="pentest-unified.html" class="nav-link">Penetration Testing</a></li>
            <li><a href="vulnerabilities-unified.html" class="nav-link">Vulnerabilities</a></li>
            <li><a href="reports-unified.html" class="nav-link">Reports</a></li>
            <li><a href="stats-unified.html" class="nav-link active">Statistics</a></li>
            <li><a href="login-unified.html" class="nav-link">Login</a></li>
        </ul>
        
        <button class="nav-toggle" id="navToggle">‚ò∞</button>
    </nav>

    <!-- Main Content -->
    <main class="cyber-main">
        <div class="cyber-container">
            <!-- Header -->
            <section class="cyber-section animate-fade-in-up">
                <div class="text-center mb-4">
                    <h1 class="cyber-section-title">üìä Security Analytics</h1>
                    <p class="cyber-section-subtitle">Advanced security metrics, trends, and interactive visualizations</p>
                </div>
            </section>

            <!-- Real-time Metrics -->
            <section class="cyber-section">
                <div class="cyber-grid cyber-grid-4">
                    <div class="cyber-stat-card animate-slide-in-left" style="animation-delay: 0.1s">
                        <div class="cyber-stat-value" id="totalScans">0</div>
                        <div class="cyber-stat-label">Total Scans</div>
                        <div class="mt-2">
                            <div class="cyber-progress">
                                <div class="cyber-progress-bar" style="width: 85%"></div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="cyber-stat-card animate-slide-in-left" style="animation-delay: 0.2s">
                        <div class="cyber-stat-value" id="avgResponseTime">0</div>
                        <div class="cyber-stat-label">Avg Response Time (ms)</div>
                        <div class="mt-2">
                            <div class="cyber-progress">
                                <div class="cyber-progress-bar" style="width: 45%; background: linear-gradient(90deg, #22c55e, #16a34a);"></div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="cyber-stat-card animate-slide-in-left" style="animation-delay: 0.3s">
                        <div class="cyber-stat-value" id="threatDetectionRate">0</div>
                        <div class="cyber-stat-label">Threat Detection Rate (%)</div>
                        <div class="mt-2">
                            <div class="cyber-progress">
                                <div class="cyber-progress-bar" style="width: 92%; background: linear-gradient(90deg, #00ffcc, #8b5cf6);"></div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="cyber-stat-card animate-slide-in-left" style="animation-delay: 0.4s">
                        <div class="cyber-stat-value" id="securityScore">0</div>
                        <div class="cyber-stat-label">Security Score</div>
                        <div class="mt-2">
                            <div class="cyber-progress">
                                <div class="cyber-progress-bar" style="width: 78%; background: linear-gradient(90deg, #f59e0b, #d97706);"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Time Range Selector -->
            <section class="cyber-section">
                <div class="cyber-card">
                    <div class="cyber-card-header">
                        <h3 class="cyber-card-title">üìÖ Time Range & Filters</h3>
                        <p class="cyber-card-subtitle">Customize your analytics view</p>
                    </div>
                    
                    <div class="cyber-grid cyber-grid-4">
                        <div>
                            <label class="block text-primary mb-2">Time Range</label>
                            <select class="cyber-select" id="timeRange" onchange="updateCharts()">
                                <option value="24h">Last 24 Hours</option>
                                <option value="7d" selected>Last 7 Days</option>
                                <option value="30d">Last 30 Days</option>
                                <option value="90d">Last 90 Days</option>
                                <option value="1y">Last Year</option>
                            </select>
                        </div>
                        
                        <div>
                            <label class="block text-primary mb-2">Metric Type</label>
                            <select class="cyber-select" id="metricType" onchange="updateCharts()">
                                <option value="vulnerabilities">Vulnerabilities</option>
                                <option value="threats">Threats</option>
                                <option value="scans">Scans</option>
                                <option value="compliance">Compliance</option>
                            </select>
                        </div>
                        
                        <div>
                            <label class="block text-primary mb-2">Group By</label>
                            <select class="cyber-select" id="groupBy" onchange="updateCharts()">
                                <option value="time">Time</option>
                                <option value="severity">Severity</option>
                                <option value="host">Host</option>
                                <option value="service">Service</option>
                            </select>
                        </div>
                        
                        <div>
                            <label class="block text-primary mb-2">Chart Type</label>
                            <select class="cyber-select" id="chartType" onchange="updateCharts()">
                                <option value="line">Line Chart</option>
                                <option value="bar">Bar Chart</option>
                                <option value="area">Area Chart</option>
                                <option value="scatter">Scatter Plot</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="flex gap-2 mt-3">
                        <button class="cyber-btn cyber-btn-primary" onclick="refreshData()">
                            üîÑ Refresh Data
                        </button>
                        <button class="cyber-btn cyber-btn-secondary" onclick="exportCharts()">
                            üì§ Export Charts
                        </button>
                        <button class="cyber-btn cyber-btn-secondary" onclick="saveView()">
                            üíæ Save View
                        </button>
                        <button class="cyber-btn cyber-btn-secondary" onclick="resetFilters()">
                            üîÑ Reset Filters
                        </button>
                    </div>
                </div>
            </section>

            <!-- Main Analytics Charts -->
            <section class="cyber-section">
                <div class="cyber-grid cyber-grid-2">
                    <!-- Trend Analysis -->
                    <div class="cyber-card">
                        <div class="cyber-card-header">
                            <h3 class="cyber-card-title">üìà Security Trends</h3>
                            <p class="cyber-card-subtitle">Historical security metrics and patterns</p>
                        </div>
                        
                        <div style="position: relative; height: 400px;">
                            <canvas id="trendChart"></canvas>
                        </div>
                        
                        <div class="flex gap-2 mt-3">
                            <button class="cyber-btn cyber-btn-secondary" onclick="toggleTrendData('vulnerabilities')">
                                üö® Vulnerabilities
                            </button>
                            <button class="cyber-btn cyber-btn-secondary" onclick="toggleTrendData('threats')">
                                ‚ö†Ô∏è Threats
                            </button>
                            <button class="cyber-btn cyber-btn-secondary" onclick="toggleTrendData('scans')">
                                üîç Scans
                            </button>
                        </div>
                    </div>
                    
                    <!-- Distribution Analysis -->
                    <div class="cyber-card">
                        <div class="cyber-card-header">
                            <h3 class="cyber-card-title">üéØ Distribution Analysis</h3>
                            <p class="cyber-card-subtitle">Breakdown by severity, type, and impact</p>
                        </div>
                        
                        <div style="position: relative; height: 400px;">
                            <canvas id="distributionChart"></canvas>
                        </div>
                        
                        <div class="flex gap-2 mt-3">
                            <button class="cyber-btn cyber-btn-secondary" onclick="changeDistribution('severity')">
                                üìä By Severity
                            </button>
                            <button class="cyber-btn cyber-btn-secondary" onclick="changeDistribution('type')">
                                üè∑Ô∏è By Type
                            </button>
                            <button class="cyber-btn cyber-btn-secondary" onclick="changeDistribution('host')">
                                üñ•Ô∏è By Host
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Advanced Visualizations -->
            <section class="cyber-section">
                <div class="cyber-grid cyber-grid-2">
                    <!-- Network Topology D3.js -->
                    <div class="cyber-card">
                        <div class="cyber-card-header">
                            <h3 class="cyber-card-title">üåê Network Topology</h3>
                            <p class="cyber-card-subtitle">Interactive network visualization with threat indicators</p>
                        </div>
                        
                        <div id="networkTopology" style="height: 400px; position: relative;">
                            <!-- D3.js network visualization -->
                        </div>
                        
                        <div class="flex gap-2 mt-3">
                            <button class="cyber-btn cyber-btn-secondary" onclick="resetNetworkView()">
                                üîÑ Reset View
                            </button>
                            <button class="cyber-btn cyber-btn-secondary" onclick="toggleNetworkLabels()">
                                üè∑Ô∏è Toggle Labels
                            </button>
                            <button class="cyber-btn cyber-btn-secondary" onclick="highlightThreats()">
                                ‚ö†Ô∏è Highlight Threats
                            </button>
                        </div>
                    </div>
                    
                    <!-- Risk Heat Map -->
                    <div class="cyber-card">
                        <div class="cyber-card-header">
                            <h3 class="cyber-card-title">üî• Risk Heat Map</h3>
                            <p class="cyber-card-subtitle">Risk distribution across assets and time</p>
                        </div>
                        
                        <div id="riskHeatMap" style="height: 400px; position: relative;">
                            <!-- D3.js heat map visualization -->
                        </div>
                        
                        <div class="flex gap-2 mt-3">
                            <button class="cyber-btn cyber-btn-secondary" onclick="changeHeatMapView('assets')">
                                üñ•Ô∏è By Assets
                            </button>
                            <button class="cyber-btn cyber-btn-secondary" onclick="changeHeatMapView('time')">
                                ‚è∞ By Time
                            </button>
                            <button class="cyber-btn cyber-btn-secondary" onclick="changeHeatMapView('services')">
                                üîß By Services
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Performance Metrics -->
            <section class="cyber-section">
                <div class="cyber-card">
                    <div class="cyber-card-header">
                        <h3 class="cyber-card-title">‚ö° Performance Metrics</h3>
                        <p class="cyber-card-subtitle">System performance and scanning efficiency</p>
                    </div>
                    
                    <div class="cyber-grid cyber-grid-3">
                        <div style="position: relative; height: 300px;">
                            <canvas id="performanceChart"></canvas>
                        </div>
                        
                        <div style="position: relative; height: 300px;">
                            <canvas id="throughputChart"></canvas>
                        </div>
                        
                        <div style="position: relative; height: 300px;">
                            <canvas id="resourceChart"></canvas>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Compliance Dashboard -->
            <section class="cyber-section">
                <div class="cyber-card">
                    <div class="cyber-card-header">
                        <h3 class="cyber-card-title">üìã Compliance Dashboard</h3>
                        <p class="cyber-card-subtitle">Regulatory compliance status and trends</p>
                    </div>
                    
                    <div class="compliance-grid">
                        <div class="compliance-item">
                            <div class="compliance-header">
                                <h4 class="text-primary">OWASP Top 10</h4>
                                <span class="cyber-badge cyber-badge-warning">78%</span>
                            </div>
                            <div class="cyber-progress mt-2">
                                <div class="cyber-progress-bar" style="width: 78%; background: linear-gradient(90deg, #f59e0b, #d97706);"></div>
                            </div>
                            <div class="compliance-details mt-2">
                                <div class="text-secondary text-sm">8/10 categories compliant</div>
                                <div class="text-secondary text-sm">Last updated: 2 days ago</div>
                            </div>
                        </div>
                        
                        <div class="compliance-item">
                            <div class="compliance-header">
                                <h4 class="text-primary">PCI DSS</h4>
                                <span class="cyber-badge cyber-badge-success">92%</span>
                            </div>
                            <div class="cyber-progress mt-2">
                                <div class="cyber-progress-bar" style="width: 92%; background: linear-gradient(90deg, #22c55e, #16a34a);"></div>
                            </div>
                            <div class="compliance-details mt-2">
                                <div class="text-secondary text-sm">11/12 requirements met</div>
                                <div class="text-secondary text-sm">Last updated: 1 day ago</div>
                            </div>
                        </div>
                        
                        <div class="compliance-item">
                            <div class="compliance-header">
                                <h4 class="text-primary">ISO 27001</h4>
                                <span class="cyber-badge cyber-badge-info">85%</span>
                            </div>
                            <div class="cyber-progress mt-2">
                                <div class="cyber-progress-bar" style="width: 85%;"></div>
                            </div>
                            <div class="compliance-details mt-2">
                                <div class="text-secondary text-sm">17/20 controls implemented</div>
                                <div class="text-secondary text-sm">Last updated: 3 days ago</div>
                            </div>
                        </div>
                        
                        <div class="compliance-item">
                            <div class="compliance-header">
                                <h4 class="text-primary">NCA</h4>
                                <span class="cyber-badge cyber-badge-info">82%</span>
                            </div>
                            <div class="cyber-progress mt-2">
                                <div class="cyber-progress-bar" style="width: 82%; background: linear-gradient(90deg, #3b82f6, #2563eb);"></div>
                            </div>
                            <div class="compliance-details mt-2">
                                <div class="text-secondary text-sm">4/5 controls implemented</div>
                                <div class="text-secondary text-sm">Last updated: 1 day ago</div>
                            </div>
                        </div>
                        
                        <div class="compliance-item">
                            <div class="compliance-header">
                                <h4 class="text-primary">SAMA</h4>
                                <span class="cyber-badge cyber-badge-warning">75%</span>
                            </div>
                            <div class="cyber-progress mt-2">
                                <div class="cyber-progress-bar" style="width: 75%; background: linear-gradient(90deg, #8b5cf6, #7c3aed);"></div>
                            </div>
                            <div class="compliance-details mt-2">
                                <div class="text-secondary text-sm">3/4 controls implemented</div>
                                <div class="text-secondary text-sm">Last updated: 2 days ago</div>
                            </div>
                        </div>
                        
                        <div class="compliance-item">
                            <div class="compliance-header">
                                <h4 class="text-primary">GDPR</h4>
                                <span class="cyber-badge cyber-badge-danger">65%</span>
                            </div>
                            <div class="cyber-progress mt-2">
                                <div class="cyber-progress-bar" style="width: 65%; background: linear-gradient(90deg, #ef4444, #dc2626);"></div>
                            </div>
                            <div class="compliance-details mt-2">
                                <div class="text-secondary text-sm">13/20 requirements met</div>
                                <div class="text-secondary text-sm">Last updated: 5 days ago</div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Real-time Activity Feed -->
            <section class="cyber-section">
                <div class="cyber-card">
                    <div class="cyber-card-header">
                        <h3 class="cyber-card-title">üì° Real-time Activity Feed</h3>
                        <p class="cyber-card-subtitle">Live security events and system activities</p>
                    </div>
                    
                    <div class="activity-feed" id="activityFeed" style="height: 300px; overflow-y: auto;">
                        <!-- Dynamic activity content -->
                    </div>
                    
                    <div class="flex gap-2 mt-3">
                        <button class="cyber-btn cyber-btn-primary" onclick="pauseActivityFeed()" id="pauseBtn">
                            ‚è∏Ô∏è Pause Feed
                        </button>
                        <button class="cyber-btn cyber-btn-secondary" onclick="clearActivityFeed()">
                            üóëÔ∏è Clear Feed
                        </button>
                        <button class="cyber-btn cyber-btn-secondary" onclick="exportActivityLog()">
                            üì§ Export Log
                        </button>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <!-- Custom Styles -->
    <style>
        .compliance-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
        }
        
        .compliance-item {
            background: var(--bg-glass-light);
            border-radius: var(--radius-md);
            padding: 1.5rem;
            border-left: 4px solid var(--accent-cyan);
        }
        
        .compliance-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }
        
        .compliance-details {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .activity-feed {
            background: var(--bg-secondary);
            border-radius: var(--radius-md);
            padding: 1rem;
            font-family: var(--font-mono);
            font-size: 0.9rem;
        }
        
        .activity-item {
            padding: 0.5rem;
            margin-bottom: 0.5rem;
            border-radius: var(--radius-sm);
            background: var(--bg-glass-light);
            border-left: 3px solid var(--accent-cyan);
        }
        
        .activity-item.warning {
            border-left-color: #f59e0b;
        }
        
        .activity-item.danger {
            border-left-color: #ef4444;
        }
        
        .activity-item.success {
            border-left-color: #22c55e;
        }
        
        .network-node {
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .network-node:hover {
            stroke-width: 3px;
        }
        
        .network-link {
            stroke: var(--accent-cyan);
            stroke-opacity: 0.6;
            stroke-width: 2px;
        }
        
        .heat-cell {
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .heat-cell:hover {
            stroke: var(--accent-cyan);
            stroke-width: 2px;
        }
    </style>

    <!-- JavaScript -->
    <script>
        // Navigation Toggle
        document.getElementById('navToggle').addEventListener('click', function() {
            const navLinks = document.getElementById('navLinks');
            navLinks.classList.toggle('active');
        });

        // Global variables
        let charts = {};
        let networkSimulation = null;
        let activityFeedPaused = false;
        let activityFeedInterval = null;
        let networkLabelsVisible = true;

        // Initialize statistics
        function initializeStats() {
            // Animate counters
            animateCounter('totalScans', 1247);
            animateCounter('avgResponseTime', 156);
            animateCounter('threatDetectionRate', 94);
            animateCounter('securityScore', 78);
            
            // Initialize charts
            initializeCharts();
            initializeNetworkTopology();
            initializeRiskHeatMap();
            startActivityFeed();
        }

        // Animate counter
        function animateCounter(elementId, targetValue, duration = 2000) {
            const element = document.getElementById(elementId);
            const startValue = parseInt(element.textContent) || 0;
            const increment = (targetValue - startValue) / (duration / 16);
            let currentValue = startValue;

            const timer = setInterval(() => {
                currentValue += increment;
                if ((increment > 0 && currentValue >= targetValue) || 
                    (increment < 0 && currentValue <= targetValue)) {
                    currentValue = targetValue;
                    clearInterval(timer);
                }
                element.textContent = Math.floor(currentValue);
            }, 16);
        }

        // Initialize charts
        function initializeCharts() {
            initializeTrendChart();
            initializeDistributionChart();
            initializePerformanceCharts();
        }

        // Initialize trend chart
        function initializeTrendChart() {
            const ctx = document.getElementById('trendChart').getContext('2d');
            
            // Generate sample data for the last 7 days
            const dates = [];
            const vulnerabilities = [];
            const threats = [];
            const scans = [];
            
            for (let i = 6; i >= 0; i--) {
                const date = new Date();
                date.setDate(date.getDate() - i);
                dates.push(date.toLocaleDateString());
                vulnerabilities.push(Math.floor(Math.random() * 20) + 10);
                threats.push(Math.floor(Math.random() * 15) + 5);
                scans.push(Math.floor(Math.random() * 50) + 20);
            }
            
            charts.trend = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: dates,
                    datasets: [{
                        label: 'Vulnerabilities',
                        data: vulnerabilities,
                        borderColor: '#ef4444',
                        backgroundColor: 'rgba(239, 68, 68, 0.1)',
                        tension: 0.4,
                        fill: true
                    }, {
                        label: 'Threats',
                        data: threats,
                        borderColor: '#f59e0b',
                        backgroundColor: 'rgba(245, 158, 11, 0.1)',
                        tension: 0.4,
                        fill: true
                    }, {
                        label: 'Scans',
                        data: scans,
                        borderColor: '#00ffcc',
                        backgroundColor: 'rgba(0, 255, 204, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        intersect: false,
                        mode: 'index'
                    },
                    scales: {
                        x: {
                            ticks: { color: '#ffffff' },
                            grid: { color: 'rgba(255, 255, 255, 0.1)' }
                        },
                        y: {
                            ticks: { color: '#ffffff' },
                            grid: { color: 'rgba(255, 255, 255, 0.1)' }
                        }
                    },
                    plugins: {
                        legend: {
                            labels: { color: '#ffffff' }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(30, 30, 40, 0.9)',
                            titleColor: '#ffffff',
                            bodyColor: '#ffffff',
                            borderColor: '#00ffcc',
                            borderWidth: 1
                        }
                    }
                }
            });
        }

        // Initialize distribution chart
        function initializeDistributionChart() {
            const ctx = document.getElementById('distributionChart').getContext('2d');
            
            charts.distribution = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Critical', 'High', 'Medium', 'Low'],
                    datasets: [{
                        data: [12, 28, 35, 15],
                        backgroundColor: ['#ef4444', '#f59e0b', '#00ffcc', '#22c55e'],
                        borderColor: '#1e1e28',
                        borderWidth: 3
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: { color: '#ffffff', padding: 20 }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(30, 30, 40, 0.9)',
                            titleColor: '#ffffff',
                            bodyColor: '#ffffff',
                            borderColor: '#00ffcc',
                            borderWidth: 1
                        }
                    }
                }
            });
        }

        // Initialize performance charts
        function initializePerformanceCharts() {
            // Performance Chart
            const perfCtx = document.getElementById('performanceChart').getContext('2d');
            charts.performance = new Chart(perfCtx, {
                type: 'line',
                data: {
                    labels: ['00:00', '04:00', '08:00', '12:00', '16:00', '20:00'],
                    datasets: [{
                        label: 'Response Time (ms)',
                        data: [120, 135, 180, 165, 145, 130],
                        borderColor: '#00ffcc',
                        backgroundColor: 'rgba(0, 255, 204, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: { ticks: { color: '#ffffff' }, grid: { color: 'rgba(255, 255, 255, 0.1)' } },
                        y: { ticks: { color: '#ffffff' }, grid: { color: 'rgba(255, 255, 255, 0.1)' } }
                    },
                    plugins: {
                        legend: { labels: { color: '#ffffff' } },
                        title: { display: true, text: 'Response Time', color: '#ffffff' }
                    }
                }
            });
            
            // Throughput Chart
            const throughputCtx = document.getElementById('throughputChart').getContext('2d');
            charts.throughput = new Chart(throughputCtx, {
                type: 'bar',
                data: {
                    labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
                    datasets: [{
                        label: 'Scans/Hour',
                        data: [45, 52, 48, 61, 55, 38, 42],
                        backgroundColor: 'rgba(139, 92, 246, 0.8)',
                        borderColor: '#8b5cf6',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: { ticks: { color: '#ffffff' }, grid: { color: 'rgba(255, 255, 255, 0.1)' } },
                        y: { ticks: { color: '#ffffff' }, grid: { color: 'rgba(255, 255, 255, 0.1)' } }
                    },
                    plugins: {
                        legend: { labels: { color: '#ffffff' } },
                        title: { display: true, text: 'Scan Throughput', color: '#ffffff' }
                    }
                }
            });
            
            // Resource Chart
            const resourceCtx = document.getElementById('resourceChart').getContext('2d');
            charts.resource = new Chart(resourceCtx, {
                type: 'radar',
                data: {
                    labels: ['CPU', 'Memory', 'Disk', 'Network', 'Threads'],
                    datasets: [{
                        label: 'Usage %',
                        data: [65, 78, 45, 82, 55],
                        borderColor: '#ec4899',
                        backgroundColor: 'rgba(236, 72, 153, 0.2)',
                        pointBackgroundColor: '#ec4899',
                        pointBorderColor: '#ffffff',
                        pointHoverBackgroundColor: '#ffffff',
                        pointHoverBorderColor: '#ec4899'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            ticks: { color: '#ffffff', backdropColor: 'transparent' },
                            grid: { color: 'rgba(255, 255, 255, 0.1)' },
                            angleLines: { color: 'rgba(255, 255, 255, 0.1)' }
                        }
                    },
                    plugins: {
                        legend: { labels: { color: '#ffffff' } },
                        title: { display: true, text: 'Resource Usage', color: '#ffffff' }
                    }
                }
            });
        }

        // Initialize network topology
        function initializeNetworkTopology() {
            const container = document.getElementById('networkTopology');
            const width = container.offsetWidth;
            const height = 400;
            
            // Clear previous visualization
            d3.select(container).selectAll('*').remove();
            
            const svg = d3.select(container)
                .append('svg')
                .attr('width', width)
                .attr('height', height);
            
            // Sample network data
            const nodes = [
                { id: 'firewall', type: 'security', risk: 'low', x: width * 0.2, y: height * 0.5 },
                { id: 'web-server', type: 'server', risk: 'high', x: width * 0.5, y: height * 0.3 },
                { id: 'db-server', type: 'database', risk: 'medium', x: width * 0.8, y: height * 0.5 },
                { id: 'workstation-1', type: 'client', risk: 'low', x: width * 0.3, y: height * 0.7 },
                { id: 'workstation-2', type: 'client', risk: 'medium', x: width * 0.7, y: height * 0.7 },
                { id: 'router', type: 'network', risk: 'low', x: width * 0.1, y: height * 0.2 }
            ];
            
            const links = [
                { source: 'router', target: 'firewall' },
                { source: 'firewall', target: 'web-server' },
                { source: 'web-server', target: 'db-server' },
                { source: 'firewall', target: 'workstation-1' },
                { source: 'firewall', target: 'workstation-2' }
            ];
            
            // Create force simulation
            networkSimulation = d3.forceSimulation(nodes)
                .force('link', d3.forceLink(links).id(d => d.id).distance(100))
                .force('charge', d3.forceManyBody().strength(-300))
                .force('center', d3.forceCenter(width / 2, height / 2));
            
            // Draw links
            const link = svg.selectAll('.network-link')
                .data(links)
                .enter()
                .append('line')
                .attr('class', 'network-link');
            
            // Draw nodes
            const node = svg.selectAll('.network-node')
                .data(nodes)
                .enter()
                .append('circle')
                .attr('class', 'network-node')
                .attr('r', 20)
                .attr('fill', d => getNodeColor(d.type, d.risk))
                .attr('stroke', '#00ffcc')
                .attr('stroke-width', 2)
                .call(d3.drag()
                    .on('start', dragstarted)
                    .on('drag', dragged)
                    .on('end', dragended))
                .on('click', function(event, d) {
                    showNodeDetails(d);
                });
            
            // Add labels
            const label = svg.selectAll('.node-label')
                .data(nodes)
                .enter()
                .append('text')
                .attr('class', 'node-label')
                .attr('text-anchor', 'middle')
                .attr('dy', 35)
                .attr('fill', '#ffffff')
                .attr('font-size', '12px')
                .text(d => d.id);
            
            // Update positions on simulation tick
            networkSimulation.on('tick', () => {
                link
                    .attr('x1', d => d.source.x)
                    .attr('y1', d => d.source.y)
                    .attr('x2', d => d.target.x)
                    .attr('y2', d => d.target.y);
                
                node
                    .attr('cx', d => d.x)
                    .attr('cy', d => d.y);
                
                label
                    .attr('x', d => d.x)
                    .attr('y', d => d.y);
            });
            
            // Drag functions
            function dragstarted(event, d) {
                if (!event.active) networkSimulation.alphaTarget(0.3).restart();
                d.fx = d.x;
                d.fy = d.y;
            }
            
            function dragged(event, d) {
                d.fx = event.x;
                d.fy = event.y;
            }
            
            function dragended(event, d) {
                if (!event.active) networkSimulation.alphaTarget(0);
                d.fx = null;
                d.fy = null;
            }
        }

        // Initialize risk heat map
        function initializeRiskHeatMap() {
            const container = document.getElementById('riskHeatMap');
            const width = container.offsetWidth;
            const height = 400;
            
            // Clear previous visualization
            d3.select(container).selectAll('*').remove();
            
            const svg = d3.select(container)
                .append('svg')
                .attr('width', width)
                .attr('height', height);
            
            // Generate heat map data
            const assets = ['Web Server', 'Database', 'Firewall', 'Router', 'Workstation'];
            const timeSlots = ['00:00', '06:00', '12:00', '18:00'];
            const data = [];
            
            assets.forEach((asset, i) => {
                timeSlots.forEach((time, j) => {
                    data.push({
                        asset: asset,
                        time: time,
                        risk: Math.random() * 10,
                        x: j,
                        y: i
                    });
                });
            });
            
            const cellWidth = width / timeSlots.length;
            const cellHeight = height / assets.length;
            
            // Color scale
            const colorScale = d3.scaleSequential(d3.interpolateReds)
                .domain([0, 10]);
            
            // Draw heat map cells
            svg.selectAll('.heat-cell')
                .data(data)
                .enter()
                .append('rect')
                .attr('class', 'heat-cell')
                .attr('x', d => d.x * cellWidth)
                .attr('y', d => d.y * cellHeight)
                .attr('width', cellWidth - 2)
                .attr('height', cellHeight - 2)
                .attr('fill', d => colorScale(d.risk))
                .attr('stroke', '#1e1e28')
                .attr('stroke-width', 1)
                .on('mouseover', function(event, d) {
                    showHeatMapTooltip(event, d);
                })
                .on('mouseout', hideHeatMapTooltip);
            
            // Add axis labels
            svg.selectAll('.x-label')
                .data(timeSlots)
                .enter()
                .append('text')
                .attr('class', 'x-label')
                .attr('x', (d, i) => i * cellWidth + cellWidth / 2)
                .attr('y', height + 20)
                .attr('text-anchor', 'middle')
                .attr('fill', '#ffffff')
                .attr('font-size', '12px')
                .text(d => d);
            
            svg.selectAll('.y-label')
                .data(assets)
                .enter()
                .append('text')
                .attr('class', 'y-label')
                .attr('x', -10)
                .attr('y', (d, i) => i * cellHeight + cellHeight / 2)
                .attr('text-anchor', 'end')
                .attr('dominant-baseline', 'middle')
                .attr('fill', '#ffffff')
                .attr('font-size', '12px')
                .text(d => d);
        }

        // Start activity feed
        function startActivityFeed() {
            const activities = [
                { type: 'info', message: 'Vulnerability scan completed on 192.168.1.10' },
                { type: 'warning', message: 'High severity vulnerability detected in web server' },
                { type: 'success', message: 'Security patch applied successfully' },
                { type: 'danger', message: 'Potential intrusion attempt blocked' },
                { type: 'info', message: 'Firewall rules updated' },
                { type: 'warning', message: 'Unusual network traffic detected' },
                { type: 'success', message: 'Backup completed successfully' },
                { type: 'info', message: 'User authentication successful' }
            ];
            
            activityFeedInterval = setInterval(() => {
                if (!activityFeedPaused) {
                    const activity = activities[Math.floor(Math.random() * activities.length)];
                    addActivityItem(activity);
                }
            }, 3000);
        }

        // Add activity item
        function addActivityItem(activity) {
            const feed = document.getElementById('activityFeed');
            const item = document.createElement('div');
            item.className = `activity-item ${activity.type}`;
            
            const timestamp = new Date().toLocaleTimeString();
            item.innerHTML = `
                <div class="flex justify-between items-start">
                    <div>
                        <div class="text-primary">${activity.message}</div>
                        <div class="text-secondary text-sm">${timestamp}</div>
                    </div>
                    <div class="cyber-badge cyber-badge-${activity.type}">${activity.type.toUpperCase()}</div>
                </div>
            `;
            
            feed.insertBefore(item, feed.firstChild);
            
            // Remove old items (keep last 20)
            while (feed.children.length > 20) {
                feed.removeChild(feed.lastChild);
            }
        }

        // Utility functions
        function getNodeColor(type, risk) {
            const baseColors = {
                'security': '#ef4444',
                'server': '#3b82f6',
                'database': '#8b5cf6',
                'client': '#22c55e',
                'network': '#f59e0b'
            };
            
            const riskMultipliers = {
                'low': 1,
                'medium': 0.7,
                'high': 0.4
            };
            
            const baseColor = baseColors[type] || '#00ffcc';
            const opacity = riskMultipliers[risk] || 1;
            
            return baseColor + Math.floor(opacity * 255).toString(16).padStart(2, '0');
        }

        function showNodeDetails(node) {
            alert(`Node: ${node.id}\nType: ${node.type}\nRisk Level: ${node.risk}`);
        }

        function showHeatMapTooltip(event, data) {
            // Tooltip implementation would go here
            console.log(`Asset: ${data.asset}, Time: ${data.time}, Risk: ${data.risk.toFixed(2)}`);
        }

        function hideHeatMapTooltip() {
            // Hide tooltip implementation
        }

        // Action functions
        function updateCharts() {
            // Update charts based on filters
            console.log('Updating charts with new filters');
        }

        function refreshData() {
            // Refresh all data
            initializeStats();
        }

        function exportCharts() {
            alert('Export charts functionality');
        }

        function saveView() {
            alert('Save view functionality');
        }

        function resetFilters() {
            document.getElementById('timeRange').value = '7d';
            document.getElementById('metricType').value = 'vulnerabilities';
            document.getElementById('groupBy').value = 'time';
            document.getElementById('chartType').value = 'line';
            updateCharts();
        }

        function toggleTrendData(dataType) {
            // Toggle trend data visibility
            console.log(`Toggling ${dataType} data`);
        }

        function changeDistribution(type) {
            // Change distribution chart type
            console.log(`Changing distribution to ${type}`);
        }

        function resetNetworkView() {
            if (networkSimulation) {
                networkSimulation.alpha(1).restart();
            }
        }

        function toggleNetworkLabels() {
            networkLabelsVisible = !networkLabelsVisible;
            d3.selectAll('.node-label')
                .style('display', networkLabelsVisible ? 'block' : 'none');
        }

        function highlightThreats() {
            d3.selectAll('.network-node')
                .transition()
                .duration(500)
                .attr('stroke-width', d => d.risk === 'high' ? 4 : 2)
                .attr('stroke', d => d.risk === 'high' ? '#ef4444' : '#00ffcc');
        }

        function changeHeatMapView(viewType) {
            console.log(`Changing heat map view to ${viewType}`);
        }

        function pauseActivityFeed() {
            activityFeedPaused = !activityFeedPaused;
            const btn = document.getElementById('pauseBtn');
            btn.textContent = activityFeedPaused ? '‚ñ∂Ô∏è Resume Feed' : '‚è∏Ô∏è Pause Feed';
        }

        function clearActivityFeed() {
            document.getElementById('activityFeed').innerHTML = '';
        }

        function exportActivityLog() {
            alert('Export activity log functionality');
        }

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            initializeStats();
        });

        // Cleanup on page unload
        window.addEventListener('beforeunload', function() {
            if (activityFeedInterval) {
                clearInterval(activityFeedInterval);
            }
        });
    </script>
</body>
</html>